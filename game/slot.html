<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>BadLand - Slot</title>
        <link rel="stylesheet" href="../assets/styles.css" />
        <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
        <style>
            main {
                background: var(--primary-color);
                color: var(--secondary-color);
                font-family: Arial, sans-serif;
                display: flex; /* Ekran boyunca flex kutusu olu≈ütur */
                justify-content: center; /* Yatayda ortalar */
                align-items: center; /* Dikeyde ortalar */
                height: calc(100vh - 60px); /* Tam ekran y√ºksekliƒüi */
                margin: 0; /* Varsayƒ±lan bo≈üluklarƒ± kaldƒ±rƒ±r */
                text-align: center;
            }

            .slot-container {
                display: inline-block;
                padding: 20px;
                background: var(--gradient);
                border-radius: 8px;
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            }

            .reels {
                display: flex;
                justify-content: center;
                margin: 20px 0;
            }

            .reel {
                width: 80px;
                height: 80px;
                margin: 0 5px;
                background: var(--primary-color);
                color: var(--secondary-color);
                font-size: 2rem;
                font-weight: bold;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 8px;
                box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
            }

            .controls {
                margin-top: 20px;
            }

            .spin-btn {
                padding: 10px 20px;
                background: var(--primary-color);
                color: var(--secondary-color);
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-size: 1rem;
            }

            .spin-btn:hover {
                background: var(--secondary-color);
                color: var(--primary-color);
            }

            .spinning {
                animation: spin 0.5s linear infinite;
            }

            @keyframes spin {
                from {
                    transform: rotateX(0deg);
                }
                to {
                    transform: rotateX(360deg);
                }
            }
        </style>
    </head>
    <body>
        <header>
            <nav class="navbar">
                <div class="nav-left">
                    <a href="/"><div class="logo">BADLAND</div></a>
                </div>
                <div class="nav-right">
                    <div class="nav-icons">
                        <a href="../help.html"><i class="bx bx-help-circle"></i></a>
                    </div>
                    <div class="game-number" id="wallet">100$</div>
                </div>
            </nav>
        </header>

        <main>
            <div class="slot-container">
                <div class="reels">
                    <div class="reel" id="reel1">üçí</div>
                    <div class="reel" id="reel2">üçã</div>
                    <div class="reel" id="reel3">üçá</div>
                </div>
                <div class="controls">
                    <button class="spin-btn" id="spin-button">Spin</button>
                </div>
            </div>
        </main>

        <script>
            const walletElement = document.getElementById("wallet");
            const spinButton = document.getElementById("spin-button");
            const reels = [document.getElementById("reel1"), document.getElementById("reel2"), document.getElementById("reel3")];
            const symbols = ["üçí", "üçã", "üçá", "‚≠ê", "üîî"];
            const betAmount = 10; // Bahis miktarƒ±
            const jackpotReward = 50; // B√ºy√ºk √∂d√ºl
            const partialMatchReward = 20; // Kƒ±smi e≈üle≈üme √∂d√ºl√º

            async function spinReels() {
                let balance = await getChip();
                if (balance < betAmount) {
                    alert("Yeterli bakiyeniz yok!");
                    return;
                }

                balance -= betAmount; // Bahis miktarƒ±nƒ± d√º≈ü
                await setChip(balance);
                walletElement.textContent = `${balance}‚Ç∫`;
                let delay = 0;

                reels.forEach((reel, index) => {
                    reel.textContent = ""; // D√∂nen makaralarƒ± bo≈ü bƒ±rak
                    reel.classList.add("spinning");

                    // Her makarayƒ± sƒ±rayla d√∂nd√ºrmek i√ßin zamanlayƒ±cƒ± kullan
                    setTimeout(() => {
                        const randomSymbol = symbols[Math.floor(Math.random() * symbols.length)];
                        reel.textContent = randomSymbol; // Sembol se√ß
                        reel.classList.remove("spinning"); // Animasyonu kaldƒ±r

                        // Son makarada e≈üle≈üme kontrol√º yap
                        if (index === reels.length - 1) {
                            checkForMatches();
                        }
                    }, delay);

                    delay += 1000; // Her makara i√ßin 1 saniyelik gecikme
                });
            }

            async function checkForMatches() {
                let balance = await getChip();

                if (reels[0].textContent === reels[1].textContent && reels[1].textContent === reels[2].textContent) {
                    balance += jackpotReward; // B√ºy√ºk √∂d√ºl
                    alert("Jackpot! You won 50!");
                } else if (reels[0].textContent === reels[1].textContent || reels[1].textContent === reels[2].textContent) {
                    balance += partialMatchReward; // Kƒ±smi √∂d√ºl
                    alert("You won 20!");
                }

                await setChip(balance);
                walletElement.textContent = `${balance}‚Ç∫`;
            }

            // Sayfa y√ºklendiƒüinde c√ºzdan bilgisi g√∂ster
            (async () => {
                let balance = await getChip();
                if (balance === 0) {
                    await setChip(100); // Ba≈ülangƒ±√ß bakiyesi
                    balance = 100;
                }
                walletElement.textContent = `${balance}‚Ç∫`;
            })();

            // Spin butonuna tƒ±klama olayƒ±nƒ± dinle
            spinButton.addEventListener("click", spinReels);
        </script>
        <script src="../assets/script.js"></script>
    </body>
</html>
